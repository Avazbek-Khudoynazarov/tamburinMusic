import{aj as P,D as t,$ as I,V as K,ak as N,Z as x,W as f,r as o,ah as Y,bg as Z,bh as $,bi as R,Y as E,bj as q,X as G,F as Q,bn as ee,bo as te,ab as se}from"./index-DJm73Gd8.js";import"./new-edit-form-DlCzfiAm.js";import{C as _,u as ae,g as le,r as oe,T as ne,a as re,e as ce,b as ie,c as de}from"./table-pagination-custom-HBR6vSg-.js";import{C as ue}from"./custom-breadcrumbs-BsaNbwZB.js";import{T as he,a as C,b as me,c as pe,d as xe}from"./table-head-custom-CEchrmhg.js";import{C as L}from"./CurriculumService-BheEP2wv.js";import{I as Ce}from"./InstrumentService-CF3tqggI.js";import{u as V,C as H,M as k,a as A}from"./ko-DBbRYMOz.js";import{C as M}from"./custom-popover-Dq5TA9U0.js";import{M as U,F as be,I as je,S as ge,O as ke}from"./TextField-B_joUv90.js";import{F as Se,a as B,c as O}from"./filters-result-BoxdpRFv.js";import{C as we}from"./Card-DCic7xzO.js";import"./index-DXqQCM1T.js";import"./form-provider-Bv2QLm_X.js";import"./fields-DRFNYTBH.js";import"./Rating-CEq9eddU.js";import"./visuallyHidden-Dan1xhjv.js";import"./InputAdornment-B7kdQGsa.js";import"./format-number-BdgaU6hH.js";import"./image-DPed605N.js";import"./ListContext-CDIiNrC7.js";import"./DatePicker-CkfG7Gz3.js";import"./listItemButtonClasses-QLc47q-U.js";import"./Tabs-BcQ-S5hI.js";import"./KeyboardArrowRight-S08dGk5c.js";import"./CardHeader-qrX2o-AK.js";import"./LoadingButton-8OnUjDzw.js";import"./DialogTitle-DFqHFKNV.js";import"./empty-content-C5UHTerm.js";import"./LastPage-Cd_46hef.js";import"./AuthService-foVeZrRB.js";function Te({row:e,selected:n,statusOptions:r,onEditRow:u,onSelectRow:d,onDeleteRow:p}){var c;const s=P(),a=V();return P(),t.jsxs(t.Fragment,{children:[t.jsxs(he,{hover:!0,selected:n,"aria-checked":n,tabIndex:-1,children:[t.jsx(C,{padding:"checkbox",children:t.jsx(H,{id:e.id.toString(),checked:n,onClick:d})}),t.jsx(C,{sx:{whiteSpace:"nowrap"},children:t.jsx(I,{color:"inherit",onClick:u,sx:{cursor:"pointer"},children:(c=e.instrument)==null?void 0:c.name})}),t.jsx(C,{sx:{whiteSpace:"nowrap"},children:t.jsx(I,{color:"inherit",onClick:u,sx:{cursor:"pointer"},children:e.name})}),t.jsx(C,{sx:{whiteSpace:"nowrap"},children:e.months}),t.jsx(C,{sx:{whiteSpace:"nowrap"},children:e.total_classes}),t.jsxs(C,{sx:{whiteSpace:"nowrap"},children:[e.price.toLocaleString()," 원"]}),t.jsx(C,{children:t.jsx(K,{direction:"row",alignItems:"center",children:t.jsx(N,{color:a.open?"inherit":"default",onClick:a.onOpen,children:t.jsx(x,{icon:"eva:more-vertical-fill"})})})})]}),t.jsx(M,{open:a.open,anchorEl:a.anchorEl,onClose:a.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(U,{children:[t.jsxs(k,{onClick:()=>{u(),a.onClose()},children:[t.jsx(x,{icon:"solar:pen-bold"}),"수정"]}),t.jsxs(k,{onClick:()=>{s.onTrue(),a.onClose()},sx:{color:"error.main"},children:[t.jsx(x,{icon:"solar:trash-bin-trash-bold"}),"삭제"]})]})}),t.jsx(_,{open:s.value,onClose:s.onFalse,title:"삭제",content:"정말 삭제 하시겠습니까?",action:t.jsx(f,{variant:"contained",color:"error",onClick:()=>{p(),s.onFalse()},children:"삭제"})})]})}function ve({filters:e,options:n,onResetPage:r,dateError:u}){const d=V(),p=o.useCallback(s=>{const a=typeof s.target.value=="string"?s.target.value.split(","):s.target.value;r(),e.setState({roleCheck1:a})},[e,r]);return o.useCallback(s=>{const a=typeof s.target.value=="string"?s.target.value.split(","):s.target.value;r(),e.setState({roleCheck2:a})},[e,r]),o.useCallback(s=>{r(),e.setState({startDate:s})},[e,r]),o.useCallback(s=>{r(),e.setState({endDate:s})},[e,r]),o.useCallback(s=>{r(),e.setState({searchKeyword:s.target.value})},[e,r]),t.jsxs(t.Fragment,{children:[t.jsx(K,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:t.jsxs(be,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[t.jsx(je,{htmlFor:"user-filter-role-select-label",children:"악기"}),t.jsx(ge,{multiple:!0,value:e.state.roleCheck1,onChange:p,input:t.jsx(ke,{label:"roleCheck1"}),renderValue:s=>s.map(a=>a).join(", "),inputProps:{id:"user-filter-role-select-label"},MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:n.roleCheck1.map(s=>t.jsxs(k,{value:s,children:[t.jsx(H,{disableRipple:!0,size:"small",checked:e.state.roleCheck1.includes(s)}),s]},s))})]})}),t.jsx(M,{open:d.open,anchorEl:d.anchorEl,onClose:d.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(U,{children:[t.jsxs(k,{onClick:()=>{d.onClose()},children:[t.jsx(x,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),t.jsxs(k,{onClick:()=>{d.onClose()},children:[t.jsx(x,{icon:"solar:import-bold"}),"Import"]}),t.jsxs(k,{onClick:()=>{d.onClose()},children:[t.jsx(x,{icon:"solar:export-bold"}),"Export"]})]})})]})}const ye=[{value:"10",label:"커리큘럼대기"},{value:"20",label:"커리큘럼완료"},{value:"all",label:"전체"}];function De({filters:e,onResetPage:n,totalResults:r,sx:u}){var a;o.useCallback(()=>{n(),e.setState({searchKeyword:""})},[e,n]);const d=o.useCallback(()=>{n(),e.setState({status:"all"})},[e,n]),p=o.useCallback(c=>{const b=e.state.roleCheck1.filter(j=>j!==c);n(),e.setState({roleCheck1:b})},[e,n]);o.useCallback(c=>{const b=e.state.roleCheck2.filter(j=>j!==c);n(),e.setState({roleCheck2:b})},[e,n]);const s=o.useCallback(()=>{n(),e.onResetState()},[e,n]);return o.useCallback(()=>{n(),e.setState({startDate:null,endDate:null})},[e,n]),t.jsxs(Se,{totalResults:r,onReset:s,sx:u,children:[t.jsx(B,{label:"Status:",isShow:e.state.status!=="all",children:t.jsx(A,{...O,label:(a=ye.find(c=>c.value===e.state.status))==null?void 0:a.label,onDelete:d,sx:{textTransform:"capitalize"}})}),t.jsx(B,{label:"악기:",isShow:!!e.state.roleCheck1.length,children:e.state.roleCheck1.map(c=>o.createElement(A,{...O,key:c,label:c,onDelete:()=>p(c)}))})]})}const Pe=[{id:"instrument.name",label:"악기"},{id:"name",label:"커리큘럼명"},{id:"months",label:"개월 수"},{id:"total_classes",label:"수업횟수"},{id:"price",label:"수강료"},{id:"",width:88}];function fe(){const e=ae(),n=Y(),r=P(),[u,d]=o.useState([]),[p,s]=o.useState([{value:"all",label:"전체"}]),a=Z({roleKeyword:"member.user_id",searchKeyword:"",roleCheck1:[],roleCheck2:[],status:"all",startDate:null,endDate:null}),c=$(a.state.startDate,a.state.endDate);o.useState(1);const[b,j]=o.useState([]),S=o.useCallback(async()=>{const l=await Ce.getAllList();l&&j(l.map(i=>i.name))},[]),m=b,g=["일반커리큘럼","정기커리큘럼"],w=["member.user_id","member.name","instrument.name","teacher.name"];o.useEffect(()=>{S()},[S]);const T=o.useCallback(async()=>{const l=await L.getAllList();l&&d(l)},[]);o.useEffect(()=>{T()},[T]);const v=o.useCallback(async l=>{await L.delete(l)&&T()},[T]),h=Fe({inputData:u,comparator:le(e.order,e.orderBy),filters:a.state,dateError:c}),y=oe(h,e.page,e.rowsPerPage),F=!!a.state.searchKeyword||a.state.roleCheck1.length>0||a.state.roleCheck2.length>0||a.state.status!=="all"||!!(a.state.startDate&&a.state.endDate),z=!h.length&&F||!h.length,W=o.useCallback(async l=>{const i=u.map(D=>D.id===l?{...D,status:40}:D);await v(l),R.success("삭제가 완료되었습니다."),d(i),e.onUpdatePageDeleteRow(y.length)},[y.length,e,u,v]),J=o.useCallback(async()=>{const l=u.map(i=>i.id===Number(e.selected[0])?{...i,status:40}:i);await Promise.all(e.selected.map(i=>v(Number(i)))),R.success("삭제가 완료되었습니다."),d(l),e.onUpdatePageDeleteRows({totalRowsInPage:y.length,totalRowsFiltered:h.length})},[h.length,y.length,e,u,v]),X=o.useCallback(l=>{n.push(E.curriculum.edit(l.toString()))},[n]);return o.useCallback((l,i)=>{e.onResetPage(),a.setState({status:i})},[a,e]),t.jsxs(t.Fragment,{children:[t.jsxs(q,{children:[t.jsx(ue,{heading:"커리큘럼 조회",links:[{name:"Home",href:"/"},{name:"커리큘럼관리",href:"/curriculum/list"},{name:"커리큘럼조회"}],action:t.jsx(f,{component:G,href:E.curriculum.new,variant:"contained",startIcon:t.jsx(x,{icon:"mingcute:add-line"}),children:"커리큘럼 등록"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(we,{children:[t.jsx(ve,{filters:a,dateError:c,onResetPage:e.onResetPage,options:{roleCheck1:m,roleCheck2:g,roleKeyword:w}}),F&&t.jsx(De,{filters:a,totalResults:h.length,onResetPage:e.onResetPage,sx:{p:2.5,pt:0}}),t.jsxs(Q,{sx:{position:"relative"},children:[t.jsx(ne,{dense:e.dense,numSelected:e.selected.length,rowCount:h.length,onSelectAllRows:l=>e.onSelectAllRows(l,h.map(i=>i.id.toString())),action:t.jsx(ee,{title:"Delete",children:t.jsx(N,{color:"primary",onClick:r.onTrue,children:t.jsx(x,{icon:"solar:trash-bin-trash-bold"})})})}),t.jsx(te,{children:t.jsxs(me,{size:e.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(pe,{order:e.order,orderBy:e.orderBy,headLabel:Pe,rowCount:h.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:l=>e.onSelectAllRows(l,h.map(i=>i.id.toString()))}),t.jsxs(xe,{children:[h.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage).map(l=>t.jsx(Te,{row:l,selected:e.selected.includes(l.id.toString()),statusOptions:p,onSelectRow:()=>e.onSelectRow(l.id.toString()),onDeleteRow:()=>W(l.id),onEditRow:()=>X(l.id)},l.id)),t.jsx(re,{height:e.dense?56:76,emptyRows:ce(e.page,e.rowsPerPage,h.length)}),t.jsx(ie,{notFound:z})]})]})})]}),t.jsx(de,{page:e.page,dense:e.dense,count:h.length,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onChangeDense:void 0,onRowsPerPageChange:e.onChangeRowsPerPage})]})]}),t.jsx(_,{open:r.value,onClose:r.onFalse,title:"삭제",content:t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:e.selected.length}),"개의 커리큘럼을 정말 삭제 하시겠습니까?"]}),action:t.jsx(f,{variant:"contained",color:"error",onClick:()=>{J(),r.onFalse()},children:"삭제"})})]})}function Fe({inputData:e,comparator:n,filters:r,dateError:u}){const{searchKeyword:d,status:p,roleCheck1:s,roleCheck2:a,roleKeyword:c,startDate:b,endDate:j}=r,S=e.map((m,g)=>[m,g]);return S.sort((m,g)=>{const w=n(m[0],g[0]);return w!==0?w:m[1]-g[1]}),e=S.map(m=>m[0]),s.length&&(e=e.filter(m=>m.instrument&&s.includes(m.instrument.name))),e}const Ie={title:"탬버린뮤직 관리자 시스템"};function ct(){return t.jsxs(t.Fragment,{children:[t.jsx(se,{children:t.jsxs("title",{children:[" ",Ie.title]})}),t.jsx(fe,{})]})}export{ct as default};
