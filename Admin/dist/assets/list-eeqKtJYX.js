import{aj as T,D as t,bq as f,V as v,ak as B,Z as x,W as P,r as l,ah as U,bg as q,bh as W,bi as R,Y as L,bj as $,X as z,F as G,bn as J,bo as X,ab as Y}from"./index-DJm73Gd8.js";import{B as _}from"./new-edit-form-4NFAsqQZ.js";import{u as Z}from"./use-params-BytqtBag.js";import{C as E,u as Q,g as ee,r as te,T as oe,a as se,e as ae,b as re,c as ne}from"./table-pagination-custom-HBR6vSg-.js";import{C as le}from"./custom-breadcrumbs-BsaNbwZB.js";import{T as ie,a as j,b as ce,c as de,d as he}from"./table-head-custom-CEchrmhg.js";import{u as K,C as ue,M as w,a as me}from"./ko-DBbRYMOz.js";import{C as A}from"./custom-popover-Dq5TA9U0.js";import{M as O,F as pe,I as xe,S as be,O as Ce,T as je}from"./TextField-B_joUv90.js";import{I as we}from"./InputAdornment-B7kdQGsa.js";import{F as ge,a as Se,c as ke}from"./filters-result-BoxdpRFv.js";import{C as ye}from"./Card-DCic7xzO.js";import"./index-DXqQCM1T.js";import"./form-provider-Bv2QLm_X.js";import"./fields-DRFNYTBH.js";import"./Rating-CEq9eddU.js";import"./visuallyHidden-Dan1xhjv.js";import"./format-number-BdgaU6hH.js";import"./image-DPed605N.js";import"./ListContext-CDIiNrC7.js";import"./DatePicker-CkfG7Gz3.js";import"./listItemButtonClasses-QLc47q-U.js";import"./Tabs-BcQ-S5hI.js";import"./KeyboardArrowRight-S08dGk5c.js";import"./AuthService-foVeZrRB.js";import"./MetaService-BYYEBCFd.js";import"./CardHeader-qrX2o-AK.js";import"./LoadingButton-8OnUjDzw.js";import"./DialogTitle-DFqHFKNV.js";import"./empty-content-C5UHTerm.js";import"./LastPage-Cd_46hef.js";function fe({row:e,selected:a,statusOptions:i,onEditRow:m,onSelectRow:c,onDeleteRow:b}){const o=T(),s=K();return T(),t.jsxs(t.Fragment,{children:[t.jsxs(ie,{hover:!0,selected:a,"aria-checked":a,tabIndex:-1,children:[t.jsx(j,{padding:"checkbox",children:t.jsx(ue,{id:e.id.toString(),checked:a,onClick:c})}),t.jsx(j,{sx:{whiteSpace:"nowrap",textAlign:"left"},children:t.jsx(f,{to:`/board/${e.id}/edit`,style:{color:"inherit",textDecoration:"none"},children:e.subject})}),t.jsx(j,{sx:{whiteSpace:"nowrap"},children:t.jsxs(f,{to:`/board/${e.id}/edit`,style:{color:"inherit",textDecoration:"none"},children:[e.writer_name," (",e.writer_id,")"]})}),t.jsx(j,{sx:{whiteSpace:"nowrap"},children:t.jsx(f,{to:`/board/${e.id}/edit`,style:{color:"inherit",textDecoration:"none"},children:e.count})}),t.jsx(j,{sx:{whiteSpace:"nowrap"},children:new Date(e.created_date).toISOString().split("T")[0]}),t.jsx(j,{children:t.jsx(v,{direction:"row",alignItems:"center",children:t.jsx(B,{color:s.open?"inherit":"default",onClick:s.onOpen,children:t.jsx(x,{icon:"eva:more-vertical-fill"})})})})]}),t.jsx(A,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(O,{children:[t.jsxs(w,{onClick:()=>{m(),s.onClose()},children:[t.jsx(x,{icon:"solar:pen-bold"}),"수정"]}),t.jsxs(w,{onClick:()=>{o.onTrue(),s.onClose()},sx:{color:"error.main"},children:[t.jsx(x,{icon:"solar:trash-bin-trash-bold"}),"삭제"]})]})}),t.jsx(E,{open:o.value,onClose:o.onFalse,title:"삭제",content:"정말 삭제 하시겠습니까?",action:t.jsx(P,{variant:"contained",color:"error",onClick:()=>{b(),o.onFalse()},children:"삭제"})})]})}function Te({filters:e,options:a,onResetPage:i,dateError:m}){const c=K();l.useCallback(o=>{const s=typeof o.target.value=="string"?o.target.value.split(","):o.target.value;i(),e.setState({roleCheck1:s})},[e,i]),l.useCallback(o=>{const s=typeof o.target.value=="string"?o.target.value.split(","):o.target.value;i(),e.setState({roleCheck2:s})},[e,i]),l.useCallback(o=>{i(),e.setState({startDate:o})},[e,i]),l.useCallback(o=>{i(),e.setState({endDate:o})},[e,i]);const b=l.useCallback(o=>{i(),e.setState({searchKeyword:o.target.value})},[e,i]);return t.jsxs(t.Fragment,{children:[t.jsxs(v,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[t.jsxs(pe,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[t.jsx(xe,{htmlFor:"user-filter-role-select-label",children:"검색 필터"}),t.jsx(be,{value:e.state.roleKeyword,onChange:o=>e.setState({roleKeyword:o.target.value}),input:t.jsx(Ce,{label:"검색 필터"}),inputProps:{id:"user-filter-role-select-label"},MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:a.roleKeyword.map(o=>t.jsx(w,{value:o,children:o==="writer_id"?"아이디":o==="writer_name"?"작성자명":o==="subject"?"제목":"내용"},o))})]}),t.jsx(v,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:t.jsx(je,{fullWidth:!0,value:e.state.searchKeyword,onChange:b,placeholder:"Search...",InputProps:{startAdornment:t.jsx(we,{position:"start",children:t.jsx(x,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]}),t.jsx(A,{open:c.open,anchorEl:c.anchorEl,onClose:c.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(O,{children:[t.jsxs(w,{onClick:()=>{c.onClose()},children:[t.jsx(x,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),t.jsxs(w,{onClick:()=>{c.onClose()},children:[t.jsx(x,{icon:"solar:import-bold"}),"Import"]}),t.jsxs(w,{onClick:()=>{c.onClose()},children:[t.jsx(x,{icon:"solar:export-bold"}),"Export"]})]})})]})}function ve({filters:e,onResetPage:a,totalResults:i,sx:m}){const c=l.useCallback(()=>{a(),e.setState({searchKeyword:""})},[e,a]);l.useCallback(()=>{a(),e.setState({status:"all"})},[e,a]),l.useCallback(o=>{const s=e.state.roleCheck1.filter(p=>p!==o);a(),e.setState({roleCheck1:s})},[e,a]),l.useCallback(o=>{const s=e.state.roleCheck2.filter(p=>p!==o);a(),e.setState({roleCheck2:s})},[e,a]);const b=l.useCallback(()=>{a(),e.onResetState()},[e,a]);return l.useCallback(()=>{a(),e.setState({startDate:null,endDate:null})},[e,a]),t.jsx(ge,{totalResults:i,onReset:b,sx:m,children:t.jsx(Se,{label:"검색어:",isShow:!!e.state.searchKeyword,children:t.jsx(me,{...ke,label:e.state.searchKeyword,onDelete:c})})})}const Pe=[{id:"subject",label:"제목",width:500},{id:"writer_name",label:"작성자"},{id:"count",label:"조회수"},{id:"created_date",label:"등록 일시"},{id:"",width:88}];function Fe(){const e=Q(),a=U(),i=T(),[m,c]=l.useState([]),[b,o]=l.useState([{value:"all",label:"전체"}]),s=q({roleKeyword:"writer_id",searchKeyword:"",roleCheck1:[],roleCheck2:[],status:"all",startDate:null,endDate:null}),p=W(s.state.startDate,s.state.endDate);l.useState(1);const F=[""],D=[""],g=["writer_id","writer_name","subject","content"],{type:n=""}=Z(),d=n==="notice"?"공지사항":n==="faq"?"자주묻는질문":"수강후기",C=l.useCallback(async()=>{const r=await _.getByType(d);r&&c(r)},[d]);l.useEffect(()=>{C()},[C]);const S=l.useCallback(async r=>{await _.delete(r)&&C()},[C]),u=De({inputData:m,comparator:ee(e.order,e.orderBy),filters:s.state,dateError:p}),k=te(u,e.page,e.rowsPerPage),I=!!s.state.searchKeyword||s.state.roleCheck1.length>0||s.state.roleCheck2.length>0||s.state.status!=="all"||!!(s.state.startDate&&s.state.endDate),V=!u.length&&I||!u.length,H=l.useCallback(async r=>{const h=m.map(y=>y.id===r?{...y,status:40}:y);await S(r),R.success("삭제가 완료되었습니다."),c(h),e.onUpdatePageDeleteRow(k.length)},[k.length,e,m,S]),M=l.useCallback(async()=>{const r=m.map(h=>h.id===Number(e.selected[0])?{...h,status:40}:h);await Promise.all(e.selected.map(h=>S(Number(h)))),R.success("삭제가 완료되었습니다."),c(r),e.onUpdatePageDeleteRows({totalRowsInPage:k.length,totalRowsFiltered:u.length})},[u.length,k.length,e,m,S]),N=l.useCallback(r=>{a.push(L.board.edit(r.toString()))},[a]);return l.useCallback((r,h)=>{e.onResetPage(),s.setState({status:h})},[s,e]),t.jsxs(t.Fragment,{children:[t.jsxs($,{children:[t.jsx(le,{heading:d,links:[{name:"Home",href:"/"},{name:"게시글관리",href:"/board/notice/list"},{name:d}],action:(n==="notice"||n==="faq")&&t.jsx(P,{component:z,href:L.board[n].new,variant:"contained",startIcon:t.jsx(x,{icon:"mingcute:add-line"}),children:"게시글 등록"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(ye,{children:[t.jsx(Te,{filters:s,dateError:p,onResetPage:e.onResetPage,options:{roleCheck1:F,roleCheck2:D,roleKeyword:g}}),I&&t.jsx(ve,{filters:s,totalResults:u.length,onResetPage:e.onResetPage,sx:{p:2.5,pt:0}}),t.jsxs(G,{sx:{position:"relative"},children:[t.jsx(oe,{dense:e.dense,numSelected:e.selected.length,rowCount:u.length,onSelectAllRows:r=>e.onSelectAllRows(r,u.map(h=>h.id.toString())),action:t.jsx(J,{title:"Delete",children:t.jsx(B,{color:"primary",onClick:i.onTrue,children:t.jsx(x,{icon:"solar:trash-bin-trash-bold"})})})}),t.jsx(X,{children:t.jsxs(ce,{size:e.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(de,{order:e.order,orderBy:e.orderBy,headLabel:Pe,rowCount:u.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:r=>e.onSelectAllRows(r,u.map(h=>h.id.toString()))}),t.jsxs(he,{children:[u.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage).map(r=>t.jsx(fe,{row:r,selected:e.selected.includes(r.id.toString()),statusOptions:b,onSelectRow:()=>e.onSelectRow(r.id.toString()),onDeleteRow:()=>H(r.id),onEditRow:()=>N(r.id)},r.id)),t.jsx(se,{height:e.dense?56:76,emptyRows:ae(e.page,e.rowsPerPage,u.length)}),t.jsx(re,{notFound:V})]})]})})]}),t.jsx(ne,{page:e.page,dense:e.dense,count:u.length,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onChangeDense:void 0,onRowsPerPageChange:e.onChangeRowsPerPage})]})]}),t.jsx(E,{open:i.value,onClose:i.onFalse,title:"삭제",content:t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:e.selected.length}),"개의 게시글을 정말 삭제 하시겠습니까?"]}),action:t.jsx(P,{variant:"contained",color:"error",onClick:()=>{M(),i.onFalse()},children:"삭제"})})]})}function De({inputData:e,comparator:a,filters:i,dateError:m}){const{searchKeyword:c,status:b,roleCheck1:o,roleCheck2:s,roleKeyword:p,startDate:F,endDate:D}=i,g=e.map((n,d)=>[n,d]);return g.sort((n,d)=>{const C=a(n[0],d[0]);return C!==0?C:n[1]-d[1]}),e=g.map(n=>n[0]),c&&(p==="writer_id"?e=e.filter(n=>n.writer_id!==void 0&&String(n.writer_id).toLowerCase().includes(c.toLowerCase())):p==="writer_name"?e=e.filter(n=>n.writer_name!==void 0&&String(n.writer_name).toLowerCase().includes(c.toLowerCase())):p==="subject"?e=e.filter(n=>{var d;return((d=n.subject)==null?void 0:d.toLowerCase().indexOf(c.toLowerCase()))!==-1}):p==="content"&&(e=e.filter(n=>{var d;return((d=n.content)==null?void 0:d.toLowerCase().indexOf(c.toLowerCase()))!==-1}))),e}const Ie={title:"탬버린뮤직 관리자 시스템"};function it(){return t.jsxs(t.Fragment,{children:[t.jsx(Y,{children:t.jsxs("title",{children:[" ",Ie.title]})}),t.jsx(Fe,{})]})}export{it as default};
