import{aj as P,D as t,V as S,$ as y,F as I,ak as _,Z as j,W as T,ah as D,r,bg as E,bh as N,bi as k,Y as R,bj as H,X as U,bn as K,bo as z,bp as V,ab as W}from"./index-DJm73Gd8.js";import"./new-edit-form-CZdTELKS.js";import{L as J}from"./label-Devs2yXx.js";import{u as X,C as Y,M as v}from"./ko-DBbRYMOz.js";import{C as M,u as Z,g as $,r as q,T as G,a as Q,e as ee,b as te,c as se}from"./table-pagination-custom-HBR6vSg-.js";import{C as ae}from"./custom-breadcrumbs-BsaNbwZB.js";import{T as oe,a as b,b as ne,c as re,d as le}from"./table-head-custom-CEchrmhg.js";import{M as L}from"./MemberService-CCBPPnBE.js";import{M as ie}from"./MetaService-BYYEBCFd.js";import{C as ce}from"./custom-popover-Dq5TA9U0.js";import{A as de}from"./Avatar-CHZSgeuZ.js";import{M as me}from"./TextField-B_joUv90.js";import{C as he}from"./Card-DCic7xzO.js";import"./index-DXqQCM1T.js";import"./form-provider-Bv2QLm_X.js";import"./fields-DRFNYTBH.js";import"./Rating-CEq9eddU.js";import"./visuallyHidden-Dan1xhjv.js";import"./InputAdornment-B7kdQGsa.js";import"./format-number-BdgaU6hH.js";import"./image-DPed605N.js";import"./ListContext-CDIiNrC7.js";import"./DatePicker-CkfG7Gz3.js";import"./listItemButtonClasses-QLc47q-U.js";import"./Tabs-BcQ-S5hI.js";import"./KeyboardArrowRight-S08dGk5c.js";import"./CardHeader-qrX2o-AK.js";import"./LoadingButton-8OnUjDzw.js";import"./AuthService-foVeZrRB.js";import"./DialogTitle-DFqHFKNV.js";import"./empty-content-C5UHTerm.js";import"./LastPage-Cd_46hef.js";function pe({row:e,selected:m,statusOptions:h,onEditRow:l,onSelectRow:i,onDeleteRow:p}){var g;const c=P(),o=X();return P(),t.jsxs(t.Fragment,{children:[t.jsxs(oe,{hover:!0,selected:m,"aria-checked":m,tabIndex:-1,children:[t.jsx(b,{padding:"checkbox",children:t.jsx(Y,{id:e.id.toString(),checked:m,onClick:i})}),t.jsx(b,{children:t.jsxs(S,{spacing:2,direction:"row",alignItems:"center",children:[t.jsx(de,{alt:e.image_file,src:e.image_file}),t.jsxs(S,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[t.jsx(y,{color:"inherit",onClick:l,sx:{cursor:"pointer"},children:e.name}),t.jsx(I,{component:"span",sx:{color:"text.disabled"},children:e.user_id})]})]})}),t.jsx(b,{sx:{whiteSpace:"nowrap"},children:t.jsx(y,{color:"inherit",onClick:l,sx:{cursor:"pointer"},children:e.cellphone})}),t.jsx(b,{sx:{whiteSpace:"nowrap"},children:e.last_login&&new Date(e.last_login).toISOString().split("T")[0]}),t.jsx(b,{sx:{whiteSpace:"nowrap"},children:new Date(e.created_date).toISOString().split("T")[0]}),t.jsx(b,{children:t.jsx(J,{variant:"soft",color:e.status===20&&"success"||e.status===40&&"error"||"default",children:(g=h.find(x=>x.value===e.status.toString()))==null?void 0:g.label})}),t.jsx(b,{children:t.jsx(S,{direction:"row",alignItems:"center",children:t.jsx(_,{color:o.open?"inherit":"default",onClick:o.onOpen,children:t.jsx(j,{icon:"eva:more-vertical-fill"})})})})]}),t.jsx(ce,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(me,{children:[t.jsxs(v,{onClick:()=>{l(),o.onClose()},children:[t.jsx(j,{icon:"solar:pen-bold"}),"수정"]}),t.jsxs(v,{onClick:()=>{c.onTrue(),o.onClose()},sx:{color:"error.main"},children:[t.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"탈퇴"]})]})}),t.jsx(M,{open:c.value,onClose:c.onFalse,title:"탈퇴",content:"정말 탈퇴처리 하시겠습니까?",action:t.jsx(T,{variant:"contained",color:"error",onClick:()=>{p(),c.onFalse()},children:"탈퇴"})})]})}const ge=[{id:"name",label:"강사 정보"},{id:"cellphone",label:"연락처"},{id:"last_login",label:"최근 접속일"},{id:"created_date",label:"가입일"},{id:"status",label:"강사 상태",width:120},{id:"",width:88}];function xe(){const e=Z(),m=D(),h=P(),[l,i]=r.useState([]),[p,c]=r.useState([{value:"all",label:"전체"}]),o=E({searchType:"id",searchKeyword:"",roleType:[],roleMarketing:[],status:"all",startDate:null,endDate:null}),g=N(o.state.startDate,o.state.endDate);r.useState(1);const x=r.useCallback(async()=>{const a=await ie.getList("memberStatus");c([{value:"all",label:"전체"},...a.map(n=>({value:n.entity_id,label:n.entity_value}))])},[]),u=r.useCallback(async()=>{const a=await L.getAllTypeList("20");a&&i(a)},[]);r.useEffect(()=>{x()},[x]),r.useEffect(()=>{u()},[u]);const f=r.useCallback(async a=>{await L.delete(a)&&u()},[u]),s=ue({inputData:l,comparator:$(e.order,e.orderBy),filters:o.state,dateError:g}),d=q(s,e.page,e.rowsPerPage),C=!!o.state.searchKeyword||o.state.roleType.length>0||o.state.roleMarketing.length>0||o.state.status!=="all"||!!(o.state.startDate&&o.state.endDate),A=!s.length&&C||!s.length,F=r.useCallback(async a=>{const n=l.map(w=>w.id===a?{...w,status:40}:w);await f(a),k.success("탈퇴가 완료되었습니다."),i(n),e.onUpdatePageDeleteRow(d.length)},[d.length,e,l,f]),B=r.useCallback(async()=>{const a=l.map(n=>n.id===Number(e.selected[0])?{...n,status:40}:n);await Promise.all(e.selected.map(n=>f(Number(n)))),k.success("탈퇴가 완료되었습니다."),i(a),e.onUpdatePageDeleteRows({totalRowsInPage:d.length,totalRowsFiltered:s.length})},[s.length,d.length,e,l,f]),O=r.useCallback(a=>{m.push(R.teacher.edit(a.toString()))},[m]);return r.useCallback((a,n)=>{e.onResetPage(),o.setState({status:n})},[o,e]),t.jsxs(t.Fragment,{children:[t.jsxs(H,{children:[t.jsx(ae,{heading:"강사 조회",links:[{name:"Home",href:"/"},{name:"강사관리",href:"/teacher/list"},{name:"강사조회"}],action:t.jsx(T,{component:U,href:R.teacher.new,variant:"contained",startIcon:t.jsx(j,{icon:"mingcute:add-line"}),children:"강사 등록"}),sx:{mb:{xs:3,md:5}}}),t.jsxs(he,{children:[t.jsxs(I,{sx:{position:"relative"},children:[t.jsx(G,{dense:e.dense,numSelected:e.selected.length,rowCount:s.length,onSelectAllRows:a=>e.onSelectAllRows(a,s.map(n=>n.id.toString())),action:t.jsx(K,{title:"Delete",children:t.jsx(_,{color:"primary",onClick:h.onTrue,children:t.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})}),t.jsx(z,{children:t.jsxs(ne,{size:e.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(re,{order:e.order,orderBy:e.orderBy,headLabel:ge,rowCount:s.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:a=>e.onSelectAllRows(a,s.map(n=>n.id.toString()))}),t.jsxs(le,{children:[s.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage).map(a=>t.jsx(pe,{row:a,selected:e.selected.includes(a.id.toString()),statusOptions:p,onSelectRow:()=>e.onSelectRow(a.id.toString()),onDeleteRow:()=>F(a.id),onEditRow:()=>O(a.id)},a.id)),t.jsx(Q,{height:e.dense?56:76,emptyRows:ee(e.page,e.rowsPerPage,s.length)}),t.jsx(te,{notFound:A})]})]})})]}),t.jsx(se,{page:e.page,dense:e.dense,count:s.length,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onChangeDense:void 0,onRowsPerPageChange:e.onChangeRowsPerPage})]})]}),t.jsx(M,{open:h.value,onClose:h.onFalse,title:"탈퇴",content:t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:e.selected.length}),"명의 강사을 정말 탈퇴처리 하시겠습니까?"]}),action:t.jsx(T,{variant:"contained",color:"error",onClick:()=>{B(),h.onFalse()},children:"탈퇴"})})]})}function ue({inputData:e,comparator:m,filters:h,dateError:l}){const{searchType:i,searchKeyword:p,status:c,roleType:o,roleMarketing:g,startDate:x,endDate:u}=h,f=e.map((s,d)=>[s,d]);return f.sort((s,d)=>{const C=m(s[0],d[0]);return C!==0?C:s[1]-d[1]}),e=f.map(s=>s[0]),p&&(i==="id"?e=e.filter(s=>s.user_id.toLowerCase().indexOf(p.toLowerCase())!==-1):i==="name"?e=e.filter(s=>s.name.toLowerCase().indexOf(p.toLowerCase())!==-1):i==="cellphone"&&(e=e.filter(s=>s.cellphone.toLowerCase().indexOf(p.toLowerCase())!==-1))),c!=="all"&&(e=e.filter(s=>s.status===Number(c))),o.length&&(e=e.filter(s=>o.includes((s.type===10,"강사")))),g.length&&(e=e.filter(s=>g.includes(s.agree_marketing==="동의"?"동의":"미동의"))),l||x&&u&&(e=e.filter(s=>V(s.created_date,x,u))),e}const fe={title:"탬버린뮤직 관리자 시스템"};function $e(){return t.jsxs(t.Fragment,{children:[t.jsx(W,{children:t.jsxs("title",{children:[" ",fe.title]})}),t.jsx(xe,{})]})}export{$e as default};
