import{aj as C,D as e,$ as B,V as E,ak as k,Z as u,W as w,ah as L,r as i,bg as O,bh as _,bi as S,Y as P,bj as N,X as H,F as M,bn as U,bo as K,ab as z}from"./index-DJm73Gd8.js";import"./new-edit-form-9zZzsYMq.js";import{C as T,u as V,g as W,r as J,T as X,a as Y,e as Z,b as $,c as q}from"./table-pagination-custom-HBR6vSg-.js";import{C as G}from"./custom-breadcrumbs-BsaNbwZB.js";import{T as Q,a as p,b as ee,c as te,d as se}from"./table-head-custom-CEchrmhg.js";import{I as f}from"./InstrumentService-CF3tqggI.js";import{u as oe,C as ae,M as R}from"./ko-DBbRYMOz.js";import{C as ne}from"./custom-popover-Dq5TA9U0.js";import{M as re}from"./TextField-B_joUv90.js";import{C as le}from"./Card-DCic7xzO.js";import"./index-DXqQCM1T.js";import"./form-provider-Bv2QLm_X.js";import"./fields-DRFNYTBH.js";import"./Rating-CEq9eddU.js";import"./visuallyHidden-Dan1xhjv.js";import"./InputAdornment-B7kdQGsa.js";import"./format-number-BdgaU6hH.js";import"./image-DPed605N.js";import"./ListContext-CDIiNrC7.js";import"./DatePicker-CkfG7Gz3.js";import"./listItemButtonClasses-QLc47q-U.js";import"./Tabs-BcQ-S5hI.js";import"./KeyboardArrowRight-S08dGk5c.js";import"./CardHeader-qrX2o-AK.js";import"./LoadingButton-8OnUjDzw.js";import"./DialogTitle-DFqHFKNV.js";import"./empty-content-C5UHTerm.js";import"./LastPage-Cd_46hef.js";import"./AuthService-foVeZrRB.js";function ie({row:t,selected:d,statusOptions:h,onEditRow:c,onSelectRow:m,onDeleteRow:r}){const l=C(),o=oe();return C(),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{hover:!0,selected:d,"aria-checked":d,tabIndex:-1,children:[e.jsx(p,{padding:"checkbox",children:e.jsx(ae,{id:t.id.toString(),checked:d,onClick:m})}),e.jsx(p,{sx:{whiteSpace:"nowrap"},children:e.jsx(B,{color:"inherit",onClick:c,sx:{cursor:"pointer"},children:t.name})}),e.jsx(p,{sx:{whiteSpace:"nowrap"},children:t.display_order}),e.jsx(p,{sx:{whiteSpace:"nowrap"},children:new Date(t.created_date).toISOString().split("T")[0]}),e.jsx(p,{children:e.jsx(E,{direction:"row",alignItems:"center",children:e.jsx(k,{color:o.open?"inherit":"default",onClick:o.onOpen,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})})})]}),e.jsx(ne,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(re,{children:[e.jsxs(R,{onClick:()=>{c(),o.onClose()},children:[e.jsx(u,{icon:"solar:pen-bold"}),"수정"]}),e.jsxs(R,{onClick:()=>{l.onTrue(),o.onClose()},sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"삭제"]})]})}),e.jsx(T,{open:l.value,onClose:l.onFalse,title:"삭제",content:"정말 삭제 하시겠습니까?",action:e.jsx(w,{variant:"contained",color:"error",onClick:()=>{r(),l.onFalse()},children:"삭제"})})]})}const ce=[{id:"name",label:"악기명"},{id:"display_order",label:"노출 순서"},{id:"created_date",label:"등록일"},{id:"",width:88}];function de(){const t=V(),d=L(),h=C(),[c,m]=i.useState([]),[r,l]=i.useState([{value:"all",label:"전체"}]),o=O({roleKeyword:"member.user_id",searchKeyword:"",roleCheck1:[],roleCheck2:[],status:"all",startDate:null,endDate:null}),D=_(o.state.startDate,o.state.endDate);i.useState(1);const g=i.useCallback(async()=>{const s=await f.getAllList();s&&m(s)},[]);i.useEffect(()=>{g()},[g]);const x=i.useCallback(async s=>{await f.delete(s)&&g()},[g]),n=me({inputData:c,comparator:W(t.order,t.orderBy),filters:o.state,dateError:D}),j=J(n,t.page,t.rowsPerPage),y=!!o.state.searchKeyword||o.state.roleCheck1.length>0||o.state.roleCheck2.length>0||o.state.status!=="all"||!!(o.state.startDate&&o.state.endDate),I=!n.length&&y||!n.length,v=i.useCallback(async s=>{const a=c.map(b=>b.id===s?{...b,status:40}:b);await x(s),S.success("삭제가 완료되었습니다."),m(a),t.onUpdatePageDeleteRow(j.length)},[j.length,t,c,x]),F=i.useCallback(async()=>{const s=c.map(a=>a.id===Number(t.selected[0])?{...a,status:40}:a);await Promise.all(t.selected.map(a=>x(Number(a)))),S.success("삭제가 완료되었습니다."),m(s),t.onUpdatePageDeleteRows({totalRowsInPage:j.length,totalRowsFiltered:n.length})},[n.length,j.length,t,c,x]),A=i.useCallback(s=>{d.push(P.instrument.edit(s.toString()))},[d]);return i.useCallback((s,a)=>{t.onResetPage(),o.setState({status:a})},[o,t]),e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(G,{heading:"악기 조회",links:[{name:"Home",href:"/"},{name:"악기관리",href:"/instrument/list"},{name:"악기조회"}],action:e.jsx(w,{component:H,href:P.instrument.new,variant:"contained",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),children:"악기 등록"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(le,{children:[e.jsxs(M,{sx:{position:"relative"},children:[e.jsx(X,{dense:t.dense,numSelected:t.selected.length,rowCount:n.length,onSelectAllRows:s=>t.onSelectAllRows(s,n.map(a=>a.id.toString())),action:e.jsx(U,{title:"Delete",children:e.jsx(k,{color:"primary",onClick:h.onTrue,children:e.jsx(u,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(K,{children:e.jsxs(ee,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(te,{order:t.order,orderBy:t.orderBy,headLabel:ce,rowCount:n.length,numSelected:t.selected.length,onSort:t.onSort,onSelectAllRows:s=>t.onSelectAllRows(s,n.map(a=>a.id.toString()))}),e.jsxs(se,{children:[n.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(s=>e.jsx(ie,{row:s,selected:t.selected.includes(s.id.toString()),statusOptions:r,onSelectRow:()=>t.onSelectRow(s.id.toString()),onDeleteRow:()=>v(s.id),onEditRow:()=>A(s.id)},s.id)),e.jsx(Y,{height:t.dense?56:76,emptyRows:Z(t.page,t.rowsPerPage,n.length)}),e.jsx($,{notFound:I})]})]})})]}),e.jsx(q,{page:t.page,dense:t.dense,count:n.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:void 0,onRowsPerPageChange:t.onChangeRowsPerPage})]})]}),e.jsx(T,{open:h.value,onClose:h.onFalse,title:"삭제",content:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:t.selected.length}),"개의 악기을 정말 삭제 하시겠습니까?"]}),action:e.jsx(w,{variant:"contained",color:"error",onClick:()=>{F(),h.onFalse()},children:"삭제"})})]})}function me({inputData:t,comparator:d,filters:h,dateError:c}){const m=t.map((r,l)=>[r,l]);return m.sort((r,l)=>{const o=d(r[0],l[0]);return o!==0?o:r[1]-l[1]}),t=m.map(r=>r[0]),t}const he={title:"탬버린뮤직 관리자 시스템"};function Ke(){return e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsxs("title",{children:[" ",he.title]})}),e.jsx(de,{})]})}export{Ke as default};
